<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
$(document).ready(function(){
  $("#passResetForm").submit(function(e){
      e.preventDefault();
    
  
    
      var url = "https://unpkg.com/realm-web@1.2.0/dist/bundle.iife.js"
    $.getScript(url, function() {
      const newpass = $("#newpass").val();
      const APP_ID = "figure-mdlbd";
      const app = new Realm.App({ id: APP_ID});
      //Grab Tokens
      const params = new URLSearchParams(window.location.search);
      const token = params.get('token');
      const tokenId = params.get('tokenId');
      //Confirm client
      app.emailPasswordAuth
        .resetPassword(token, tokenId, newpass)
        .then(() => displayResult('success'))
        .catch(err => displayResult('error', err))
      //Display Message depending on result
      function displayResult(result, err) {
          if (result === "success") {
            alert("Password Resetted");
          }
          else if (result === "error") {
            alert("Password Reset Failed: token: " + token + " tokenId: " + tokenId);
          }
        }
    }).fail(function() {
    alert("fail");
    });
  
  });
  $("#newpass").change(function() {
      var newpass = $("#newpass").val();
    var confirmpass = $("#confirmpass").val();
      if (newpass == confirmpass) {
        $("#submit").prop("disabled", false);
    } else {
        $("#submit").prop("disabled", true);
    }
});

  $("#confirmpass").change(function() {
      var newpass = $("#newpass").val();
    var confirmpass = $("#confirmpass").val();
      if (newpass == confirmpass) {
        $("#submit").prop("disabled", false);
    } else {
        $("#submit").prop("disabled", true);
    }
});

  
});
</script>
</head>
<body>
<h1>Reset Password</h1>
<form id="passResetForm">
<label for="newpass">New Password (8 characters minimum):</label>
<li><input type="password" id="newpass" name="newPassword" minlength="8" required></li>
<label for="confirmpass">Confirm Password:</label>
<li><input type="password" id="confirmpass" name="confirmPassword" minlength="8" required></li>
<input type="submit" id="submit">
</form>

</body>
</html>